<!DOCTYPE html>
<html>
<head>

	<title>Survey</title>

	<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.0.0-beta1/jquery.min.js"></script>
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.97.6/css/materialize.min.css">	
	<script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.97.6/js/materialize.min.js"></script>
	<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">



</head>
<body>

<!-- Container for the Materialize framework. -->
<div class='container'>

	<div class='row'>
		<div class='col s12 m12 center-align'>
			<h1>Survey</h1>
		</div>
	</div>

	<!-- The Survey Form -->
	<div class='row'>
		<div class='s6 offset-s6'>
			<form>

				<!-- About You Header -->
				<div class="section">
					<h4>About You</h4>
					<div class="divider"></div>
				</div>


				<!-- Name Input -->
				<div class="row">
					<div class="input-field col s6">
						<i class="material-icons prefix">account_circle</i>
						<input id="nameInput" type="text" class="validate">
						<label class="active" for="nameInput">Name</label>
					</div>
				</div>

				<!-- Image Link Input -->
				<div class="row">
					<div class="input-field col s6">
						<i class="material-icons prefix">perm_media</i>
						<input id="imageLink" type="text" class="validate">
						<label class="active" for="imageLink">Image Link</label>
					</div>
				</div>

				<!-- Questions Header -->
				<div class="section">
					<h4>Survey Questions</h4>
					<div class="divider"></div>
				</div>
				
				
				<!-- Questions -->
				<div class='section'>
					<p>1) I like Star Wars more than Star Trek</p>
					<input name="question1" type="radio" id="star1" value="1"/>
					<label for="star1">Strongly Disagree</label>
					<input name="question1" type="radio" id="star2" value="2"/>
					<label for="star2">Disagree</label>
					<input name="question1" type="radio" id="star3"  value="3"/>
					<label for="star3">Neutral</label>
					<input name="question1" type="radio" id="star4" value="4" />
					<label for="star4">Agree</label>
					<input name="question1" type="radio" id="star5" value="5" />
					<label for="star5">Strongly Agree</label>
				</div>

				<div class='section'>
					<p>2) I like Marvel more than DC</p>
					<input name="question2" type="radio" id="comic1" value="1"/>
					<label for="comic1">Strongly Disagree</label>
					<input name="question2" type="radio" id="comic2" value="2"/>
					<label for="comic2">Disagree</label>
					<input name="question2" type="radio" id="comic3"  value="3"/>
					<label for="comic3">Neutral</label>
					<input name="question2" type="radio" id="comic4" value="4" />
					<label for="comic4">Agree</label>
					<input name="question2" type="radio" id="comic5" value="5" />
					<label for="comic5">Strongly Agree</label>
				</div>

				<div class='section'>
					<p>3) I like Superman more than Batman</p>
					<input name="question3" type="radio" id="super1" value="1"/>
					<label for="super1">Strongly Disagree</label>
					<input name="question3" type="radio" id="super2" value="2"/>
					<label for="super2">Disagree</label>
					<input name="question3" type="radio" id="super3"  value="3"/>
					<label for="super3">Neutral</label>
					<input name="question3" type="radio" id="super4" value="4" />
					<label for="super4">Agree</label>
					<input name="question3" type="radio" id="super5" value="5" />
					<label for="super5">Strongly Agree</label>
				</div>

				<div class='section'>
					<p>4) I like Coke more than Pepsi</p>
					<input name="question4" type="radio" id="coke1" value="1"/>
					<label for="coke1">Strongly Disagree</label>
					<input name="question4" type="radio" id="coke2" value="2"/>
					<label for="coke2">Disagree</label>
					<input name="question4" type="radio" id="coke3"  value="3"/>
					<label for="coke3">Neutral</label>
					<input name="question4" type="radio" id="coke4" value="4" />
					<label for="coke4">Agree</label>
					<input name="question4" type="radio" id="coke5" value="5" />
					<label for="coke5">Strongly Agree</label>
				</div>

				<div class='section'>
					<p>5) I like fall more than spring</p>
					<input name="question5" type="radio" id="season1" value="1"/>
					<label for="season1">Strongly Disagree</label>
					<input name="question5" type="radio" id="season2" value="2"/>
					<label for="season2">Disagree</label>
					<input name="question5" type="radio" id="season3"  value="3"/>
					<label for="season3">Neutral</label>
					<input name="question5" type="radio" id="season4" value="4" />
					<label for="season4">Agree</label>
					<input name="question5" type="radio" id="season5" value="5" />
					<label for="season5">Strongly Agree</label>
				</div>

				<div class='section'>
					<p>6) I like coffee more than tea</p>
					<input name="question6" type="radio" id="drink1" value="1"/>
					<label for="drink1">Strongly Disagree</label>
					<input name="question6" type="radio" id="drink2" value="2"/>
					<label for="drink2">Disagree</label>
					<input name="question6" type="radio" id="drink3"  value="3"/>
					<label for="drink3">Neutral</label>
					<input name="question6" type="radio" id="drink4" value="4" />
					<label for="drink4">Agree</label>
					<input name="question6" type="radio" id="drink5" value="5" />
					<label for="drink5">Strongly Agree</label>
				</div>

				<div class='section'>
					<p>7) I like cats more than dogs</p>
					<input name="question7" type="radio" id="pet1" value="1"/>
					<label for="pet1">Strongly Disagree</label>
					<input name="question7" type="radio" id="pet2" value="2"/>
					<label for="pet2">Disagree</label>
					<input name="question7" type="radio" id="pet3"  value="3"/>
					<label for="pet3">Neutral</label>
					<input name="question7" type="radio" id="pet4" value="4" />
					<label for="pet4">Agree</label>
					<input name="question7" type="radio" id="pet5" value="5" />
					<label for="pet5">Strongly Agree</label>
				</div>

				<div class='section'>
					<p>8) I like Seinfeld more than Friends</p>
					<input name="question8" type="radio" id="show1" value="1"/>
					<label for="show1">Strongly Disagree</label>
					<input name="question8" type="radio" id="show2" value="2"/>
					<label for="show2">Disagree</label>
					<input name="question8" type="radio" id="show3"  value="3"/>
					<label for="show3">Neutral</label>
					<input name="question8" type="radio" id="show4" value="4" />
					<label for="show4">Agree</label>
					<input name="question8" type="radio" id="show5" value="5" />
					<label for="show5">Strongly Agree</label>
				</div>

				<div class='section'>
					<p>9) I like PC more than Mac</p>
					<input name="question9" type="radio" id="computer1" value="1"/>
					<label for="computer1">Strongly Disagree</label>
					<input name="question9" type="radio" id="computer2" value="2"/>
					<label for="computer2">Disagree</label>
					<input name="question9" type="radio" id="computer3"  value="3"/>
					<label for="computer3">Neutral</label>
					<input name="question9" type="radio" id="computer4" value="4" />
					<label for="computer4">Agree</label>
					<input name="question9" type="radio" id="computer5" value="5" />
					<label for="computer5">Strongly Agree</label>
				</div>

				<div class='section'>
					<p>10) I like McDonalds more than Burger King</p>
					<input name="question10" type="radio" id="food1" value="1"/>
					<label for="food1">Strongly Disagree</label>
					<input name="question10" type="radio" id="food2" value="2"/>
					<label for="food2">Disagree</label>
					<input name="question10" type="radio" id="food3"  value="3"/>
					<label for="food3">Neutral</label>
					<input name="question10" type="radio" id="food4" value="4" />
					<label for="food4">Agree</label>
					<input name="question10" type="radio" id="food5" value="5" />
					<label for="food5">Strongly Agree</label>
				</div>

				<div class='section'>
				<button class="waves-effect waves-light btn-large" id="submit" type="button">Match Me!</button>
				</div>

				<!-- Modal Structure -->
				<div id="modal1" class="modal">
					<div class="modal-content">
						<h4>Your closest match was...</h4>
						<span id='modalArea'></span>
					</div>
					<div class="modal-footer">
						<a href="/" class=" modal-action modal-close waves-effect waves-green btn-flat">Ok</a>
					</div>
				</div>

			</form>
		</div>
	</div>

	<!-- Links Button -->
	<div class="fixed-action-btn" style="bottom: 45px; right: 24px;">
		<a class="btn-floating btn-large red">
			<i class="large material-icons">settings</i>
		</a>
		<ul>
			<li><a class="btn-floating yellow darken-1 tooltipped" data-position="left" data-delay="50" data-tooltip="Github Repo" href="https://github.com/osoleimani75/FriendFinder.git" target="_blank"><i class="material-icons">code</i></a></li>
			<li><a class="btn-floating green tooltipped" data-position="left" data-delay="50" data-tooltip="API" href="/api/friends" target="_blank"><i class="material-icons">subject</i></a></li>
		</ul>
	</div>

</div>

<script type="text/javascript">

	$("#submit").click(function(){

		// Checking to input a name & image.
		if ( $('#nameInput').val() == null || $('#imageLink').val() == null ) {
			alert("Please fill out all questions!2");
			return false;
		};

		// Checking to answered questins
		for (var i = 1; i <= 10; i++) {
			if ( $("input:radio[name=question"+i+"]:checked").val() == null ) {
				alert("Please fill out all questions!1");
				return false;
			};
		};

        // create array of questions
		var scoreArray = [];
		for (var i = 1; i <= 10; i++) {
			scoreArray.push(parseInt($("input:radio[name=question"+i+"]:checked").val()) );
		}

        // create an object 
		var person = {
			name: $('#nameInput').val(),
			image: $('#imageLink').val(),
			scores: scoreArray
		};
		
		var currentURL = window.location.origin;
		 newmatch='';
		$.get('/api/friends', function(data, status){
			var match=0, matchScore=0
			for (var i=0; i<data.length; i++){
				var score=0
				for (var j=0; j<data.length; j++)
					if (data[i].scores[j]== person.scores[j]){
						score +=1;
						console.log(data[i].scores[j]+" "+ person.scores[j])
					}
				if (matchScore <score){
					matchScore= score;
					console.log(matchScore+" "+ score)

					match=i;
				}
			}
			 newmatch = data[match]
			 $('#modal1').openModal();
			$('#modalArea').empty()
			$('#modalArea').append('<img class="circle" src="'+newmatch.image+'"">')
			$('#modalArea').append("<h5>" + newmatch.name + " !</h5>")
		});
        $.post(currentURL+'/api/friends', person).done(function(data){


		});



    });

</script>
</body>
</html>
